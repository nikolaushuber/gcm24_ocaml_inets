<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>GCM 2024</title>

		<link rel="shortcut icon" type="image/x-icon" href="uu_logo/UU_logo_color-cropped.ico">

		<link rel="stylesheet" href="reveal.js/dist/reset.css">
		<link rel="stylesheet" href="reveal.js/dist/reveal.css">
		<link rel="stylesheet" href="reveal.js/dist/theme/black.css">

		<!-- Tabler icons -->
		<link rel="stylesheet" href="tabler-icons/iconfont/tabler-icons.min.css">

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="atomic-one-dark.css">

		<!-- Custom css -->
		<link rel="stylesheet" href="style.css">
	</head>
	<body>
		<img class="logo" src="uu_logo/UU_logo_vit-cropped.svg">
		<div class="reveal">
			<div class="slides">
<!-- BEGIN SLIDES -->
<section data-background-image="images/robin-glauser-zP7X_B86xOg-unsplash.jpg" data-background-opacity="0.1">
	<h2>An Encoding of Interaction Nets in OCaml</h1>
		<br>
		<div>Nikolaus Huber & Wang Yi</div>
		<div>Uppsala University</div>
</section>

<section>
	<h3>Overview</h3>
	<ul>
		<li>Interaction nets</li>
		<li>OCaml</li>
		<li>Encoding</li>
		<li>Benchmarks</li>
		<li>Conclusion & future work</li>
	</ul>
</section>

<section>
	<h3>Interaction nets</h3>
	<ul>
		<li>Visual programming language</li>
		<li>Invented by Yves Lafont [1]</li>
		<li>Used for optimal [2] and efficient [3] implementations of $\lambda$-calculus
	</ul>
	<div class="citation">
		<div class="cite">[1] Interaction Nets</div>
		<div class="source">Yves Lafont<br>
		ACM SIGPLAN-SIGACT Symposium on Principles of Programming lLanguages (POPL 1990)</div>
	</div>
	<div class="citation">
		<div class="cite">[2] The geometry of optimal lambda reduction</div>
		<div class="source">Georges Gonthier, Martín Abadi & Jean-Jacques Lévy<br>
		ACM SIGPLAN-SIGACT Symposium on Principles of Programming Languages (POPL 1992)</div>
	</div>
	<div class="citation">
		<div class="cite">[3] YALE: yet another lambda evaluator based on interaction nets</div>
		<div class="source">Ian Mackie<br>
			ACM SIGPLAN International Conference on Functional Programming (ICFP 1998)</div>
	</div>
</section>

<section>
	<h3>Properties of Interaction nets</h3>

	<ul>
		<li>Locality of reduction</li>
		<ul style="list-style:none">
			<li><emph>$\Rightarrow$ parallelism</emph></li>
		</ul>
		<li>Strong confluence</li>
		<ul style="list-style:none">
			<li><emph>$\Rightarrow$ determinism</emph></li>
		</ul>
		<li>Turing complete</li>
	</ul>
</section>

<section>
	<h3>Agents</h3>
	<img width="60%" src="images/agent_examples.drawio.png" />
	<p class="fragment">$\alpha, \beta, \gamma \in \Sigma$ &nbsp; (label set)</p>
	<p class="fragment">$ar : \Sigma \rightarrow \mathbb{N}$ &nbsp; (arity function)</p>
</section>

<section>
	<h3>Rules</h3>
	<img width="90%" src="images/inet_rule.drawio.png" />
	<p class="fragment">$(\alpha \times \beta \rightarrow N) \in \mathscr{R}$ &nbsp; (rule set)</p>
</section>

<section>
	<h3>Rule application</h3>
	<ul>
		<li class="fragment">Rules are symmetric: <br>$(\alpha \times \beta) \rightarrow N \equiv (\beta \times \alpha) \rightarrow N$</li>
		<li class="fragment">For each pair $\alpha \times \beta$ there is <emph>at most one rule</emph> in $\mathscr{R}$</li>
		<li class="fragment">Rewriting must <emph>preserve the interface</emph> of the active pair</li>
	</ul>
	<p class="fragment">$\Rightarrow$ rewriting is <emph>strongly confluent</emph></p>
</section>

<section data-auto-animate>
	<h3>Typed agents</h3>
	<img width="60%" src="images/typed_agent_example.drawio.png" />
	<ul>
		<li class="fragment">value type (int, bool, list, ...)</li>
		<li class="fragment">polarity ($+$, $-$)</li>
	</ul>
</section>

<section>
	<h3>OCaml</h3>

	<ul>
		<li>Industrial strength, (mostly) functional language</li>
		<li>Member of the ML family</li>
		<li>Strong background in formal methods</li>
		<ul>
			<li>Coq / Rocq</li>
			<li>Frama-C</li>
		</ul>
		<li>Recently got native support for parallelism</li>
	</ul>
</section>

<section>
	<h3>Multicore OCaml</h3>
	<ul>
		<li>Basic unit of parallelism: <emph>domain</emph></li>
		<li>Map directly to OS threads</li>
		<li>Costly to create and tear down</li>
		<li>Stdlib only offers low-level interface</li>
		<li>Many libraries have been developed on-top:</li>
		<ul>
			<li>domainslib, kcas, picos, moonpool, ...</li>
	</ul>
</section>

<section>
	<h3>Common API for this paper</h3>
	<pre class="OCaml"><code data-trim data-noescape data-line-numbers="|1|2,3|4|5|6|7|8|9|">
		type pool
		type 'a promise
		type 'a resolver
		val resolve : 'a resolver -> 'a -> unit
		val await : 'a promise -> 'a
		val block : 'a promise -> 'a
		val make_future : unit -> 'a promise * 'a resolver
		val create_pool : int -> pool
		val run_async : pool -> (unit -> unit) -> unit
	</code></pre>
</section>

<section data-auto-animate>
	<h3>Example</h3>
	<img width="60%" src="images/bool_agents.drawio.png" />
</section>

<section data-auto-animate>
	<h3>First encoding</h3>
	<div class="container">
		<div class="col">
			<img src="images/bool_agents.drawio.png" />
		</div>
		<div class="col">
			<pre class="OCaml" data-id="encoding-code"><code data-trim data-noescape data-line-numbers="|1-4|6-9|8|">
				type id =
					| T
					| F
					| And

				type agent = {
					id : id;
					ports : agent Array.t;
				}
			</code></pre>
		</div>
	</div>
	<!-- <p class="fragment">Arity constraint not enforced</p> -->
	<div class="fragment citation">
		<div class="cite">Compilation of Interaction Nets</div>
		<div class="source">Abubakar Hassan, Ian Mackie, Shinya Sato <br>
		Electronic Notes in Theoretical Computer Science 253 (2009)</div>
	</div>
	<div class="fragment citation">
		<div class="cite">A Simple Parallel Implementation of Interaction Nets in Haskell</div>
		<div class="source">Wolfram Kahl <br>
		Electronic Proceedings in Theoretical Computer Science 179 (2015)</div>
	</div>
</section>

<section data-auto-animate>
	<h3>Second encoding</h3>
	<div class="container">
		<div class="col">
			<img src="images/bool_agents.drawio.png" />
		</div>
		<div class="col">
			<pre class="OCaml" data-id="encoding-code"><code data-trim data-noescape data-line-numbers="|1-4|6-9|8|">
				type agent =
					| T
					| F
					| And of agent * agent
			</code></pre>
		</div>
	</div>
	<ul>
		<li>Arity is enforced by type-system</li>
		<li>A value of type <emph>agent</emph> represents the principle port</li>
		<li>Nets are constructed by recursive application of constructors</li>
	</ul>
</section>

<section data-auto-animate>
	<h3>Auxiliary connections</h3>
	<img width="40%" src="images/example_aux_connect.drawio.png" />
</section>

<section data-auto-animate>
	<h3>Auxiliary connections</h3>
	<div class="container">
		<div class="col">
			<img width="60%" src="images/example_aux_connect.drawio.png" />
		</div>
		<div class="col">
			<img src="images/example_conn_names.drawio.png" />
		</div>
	</div>
</section>

<section data-auto-animate>
	<h3>Auxiliary connections</h3>
	<div class="container">
		<div class="col">
			<img src="images/example_conn_names.drawio.png" />
		</div>
		<div class="col">
			<pre class="OCaml" data-id="encoding-code"><code data-trim data-noescape data-line-numbers>
				type agent =
					| T
					| F
					| And of agent * agent
					| NamePos of agent promise
					| NameNeg of agent resolver
			</code></pre>
		</div>
	</div>
	<pre class="OCaml"><code data-trim data-noescape data-line-numbers>
		let new_name () =
			let promise, resolver = make_future () in
			NamePos promise, NameNeg resolver
	</code></pre>
</section>

<section data-auto-animate>
	<h3>Encoding rule application</h3>
	<img width="60%" src="images/rule_true_and.drawio.png" />
</section>

<section data-auto-animate>
	<h3>Encoding rule application</h3>
	<div class="container">
		<div class="col" style="flex: 0.5">
			<img width="90%" src="images/rule_true_and.drawio.png" />
		</div>
		<div class="col">
			<pre class="OCaml" data-id="encoding-code"><code data-trim data-noescape data-line-numbers="|3,4|6|8-10|">
				let rec apply_rule a1 a2 =
					match a1, a2 with
					| T, And (r, b)
					| And (r, b), T  -> b -><- r
				
					| _, _  -> failwith "No rule"

				and ( -><- ) a1 a2 =
					run_async pool
						(fun _ -> apply_rule a1 a2)
			</code></pre>
		</div>
	</div>
</section>

<section data-auto-animate>
	<h3>Encoding rule application</h3>
	<img width="60%" src="images/rule_false_and.drawio.png" />
</section>

<section data-auto-animate>
	<h3>Encoding rule application</h3>
	<div class="container">
		<div class="col" style="flex: 0.8">
			<img width="90%" src="images/rule_false_and.drawio.png" />
		</div>
		<div class="col">
			<pre class="OCaml" data-id="encoding-code"><code data-trim data-noescape data-line-numbers="|4,5|">
				let rec apply_rule a1 a2 =
					match a1, a2 with
					...
					| F, And (r, _)
					| And (r, _), F -> F -><- r
					...
			</code></pre>
		</div>
	</div>
</section>

<section data-auto-animate>
	<h3>Encoding rule application</h3>
	<pre class="OCaml" data-id="encoding-code"><code data-trim data-noescape data-line-numbers="">
		let rec apply_rule a1 a2 = match a1, a2 with 
			| T, And (r, b)
			| And (r, b), T  -> b -><- r

			| F, And (r, b)
			| And (r, _), F  -> F -><- r

			| NamePos v, a
			| a, NamePos v   -> await v -><- a

			| NameNeg v, a
			| a, NameNeg v   -> resolve v a

			| _, _           -> failwith "No rule"
	</code></pre>
</section>

<section data-auto-animate>
	<h3>Agent attributes</h3>
	<img width="80%" src="images/bool_int_agents.drawio.png" />
</section>

<section data-auto-animate>
	<h3>Agent attributes</h3>
	<img width="70%" src="images/bool_int_agents.drawio.png" />
	<pre class="OCaml" data-id="encoding-code"><code data-trim data-noescape data-line-numbers="">
		type agent =
			| Int of int
			| IsEven of agent
			| T
			| F
			| And of agent * agent
			| NamePos of agent promise
			| NameNeg of agent resolver
	</code></pre>
</section>

<section data-auto-animate>
	<h3>Agent attributes</h3>
	<img width="70%" src="images/rule_int_iseven.drawio.png" />
</section>

<section data-auto-animate>
	<h3>Agent attributes</h3>
	<div class="container">
		<div class="col" style="flex: 0.6">
			<img src="images/rule_int_iseven.drawio.png" />
		</div>
		<div class="col">
			<pre class="OCaml" data-id="encoding-code"><code data-trim data-noescape data-line-numbers="|4,5|">
				let rec apply_rule a1 a2 =
					match a1, a2 with
					...
					| IsEven r, Int n
					| Int n, IsEven r when n mod 2 = 0
						-> T -><- r

					| IsEven r, Int _
					| Int _, IsEven r
						-> F -><- r
					...
			</code></pre>
		</div>
	</div>
</section>

<section>
	<h3>Problems</h3>
	<ul>
		<li>Symmetry $\Rightarrow$ verbosity</li>
		<li>Catch-all case</li>
	</ul>
</section>

<section>
	<h3>Outline</h3>

	<ul class="box-list">
		<li><i class="ti ti-cpu"></i>Embedded Systems</li>
		<li><i class="ti ti-affiliate"></i>Organization</li>
		<li><i class="ti ti-code-circle-2"></i>Hardware + SDK</li>
	</ul>
</section>

<section data-background-image="images/adi-goldstein-EUsVwEOsblE-unsplash.jpg" data-background-opacity="0.2">
	<h1>Embedded Systems</h1>
</section>

<section>
	<h3>Embedded Systems</h3>
	<ul>
		<li>Computer systems <emph>integrated</emph> into a larger device</li>
		<li><emph>HW + SW</emph> tailored to a specific purpose</li>
		<li>Make up about <emph>99%</emph> of all computer devices</li>
		<li><emph>Pervasive</emph> character</li>
	</ul>
</section>

<section>
	<section>
		<h1>Constraints</h1>
	</section>

	<section>
		<ul class="box-list">
			<li class="fragment fade-up"><i class="ti ti-alarm"></i>Timing</li>
			<li class="fragment fade-up"><i class="ti ti-coin-euro"></i>Cost</li>
			<li class="fragment fade-up"><i class="ti ti-weight"></i>Weight</li>
			<li class="fragment fade-up"><i class="ti ti-battery-2"></i>Power</li>
			<li class="fragment fade-up"><i class="ti ti-device-sd-card"></i>Memory</li>
			<li class="fragment fade-up"><i class="ti ti-cpu"></i>Computation power</li>
		</ul>
	</section>
</section>

<section>
	<section>
		<h1>Organization</h1>
	</section>

	<!-- <section>
		<h3>Teachers</h3>
		<div class="third-part">
			<img class="photo" src="images/Nick.jpeg">
			<p class="name">Nick</p>
		</div>
		<div class="third-part">
			<img class="photo" src="images/Tobias.jpg">
			<p class="name">Tobias</p>
		</div>
		<div class="third-part">
			<img class="photo" src="images/Mikolai.jpg">
			<p class="name">Mikolai</p>
		</div>
	</section> -->

	<section>
		<h3>Course structure</h3>
		<div class="fragment fade-up box">
			Part 1: 1DT106, Period 3<br>
			&plusmn;12 lectures, 4 labs
		</div>
		<div class="fragment fade-up box">
			Exam: March 11th, 2024
		</div>
		<div class="fragment fade-up box">
			Part 2: 1DT108, Period 4<br>
			(separate application required)
		</div>
	</section>
</section>

<section>
<section data-background-color="white">
	<img class="r-stretch" src="images/cat.jpeg" alt="Book cover, Title: Changing Stuff and Seeing What Happens">
</section>

<section>
	<h3>Lab assignments</h3>
	<ul>
		<li>Labs are done <emph>individually</emph></li>
		<li>Assessment:</li>
		<ul>
			<li>Must show a <emph>working solution</emph> to one of the teachers</li>
			<li>Code upload on Studium => <emph>plagiarism check</emph></li>
		</ul>
	</ul>
</section>

<section>
	<h3>Lab topics</h3>
	<ul class="box-list">
		<li class="fragment fade-up"><i class="ti ti-schema"></i>State machines</li>
		<li class="fragment fade-up"><i class="ti ti-cpu"></i>RTOS Basics</li>
		<li class="fragment fade-up"><i class="ti ti-components"></i>Working with external hardware</li>
		<li class="fragment fade-up"><i class="ti ti-zoom-check"></i>Verification with Frama-C</li>
	</ul>
</section>

<section>
	<h3>Lab kits</h3>
	<ul>
		<li>Distributed during first lab</li>
		<li>Yours for the duration of the course</li>
		<li>If something breaks => inform teacher/TAs</li>
		<li class="fragment highlight-red">Property of Uppsala University</li>
	</ul>
</section>

<section>
	<h3>Course schedule</h3>
	<ul>
		<li>On TimeEdit (look for 1DT106)</li>
		<li>On Studium (left menu)</li>
		<li>For each lab => 2 sessions</li>
		<ul>
			<li>Marked as <emph>Lab X.1</emph> and <emph>Lab X.2</emph></li>
			<li>You can work individually between the sessions</li>
		</ul>
	</ul>
</section>

<section>
	<h3>Examination</h3>
	<ul>
		<li>March 11th, 2024</li>
		<li>On INSPERA</li>
		<li>60 Points in total</li>
		<ul>
			<li>[30, 39] => 3</li>
			<li>[40, 49] => 4</li>
			<li>[50, 60] => 5</li>
		</ul>
	</ul>
</section>

</section>

<section>
<section>
	<h1>Hardware</h1>
</section>

<section data-background-image="images/pico.jpg" data-background-opacity="1.0">
</section>

<section data-background-color="white">
	<img src="images/raspberry-pi-pico-pinout.png" alt="Raspberry Pi Pico Pinout">
</section>

<section>
	<h3>RP2040</h3>
	<ul>
		<li>Dual-core ARM Cortex-M0+</li>
		<li>264kB on-chip SRAM</li>
		<li>2MB on-board flash</li>
		<li>2x UART, 2x SPI, 2x I2C, 16x PWM</li>
		<li>Programmable I/O</li>
		<li>USB-drive bootloader</li>
	</ul>
</section>

<section data-background-color="white">
	<img src="images/MakerPiPico-PinRef-Front-rev1.2-800-lres.png" alt="Maker Pi Pico board layout">
</section>

<section>
	<h3>Lab software</h3>
	<div class="row">
		<div class="column">
			<img width="200" src="images/570px-Raspberry_Pi_Logo.svg.png" alt="Raspberry Pi Logo">
		</div>
		<div class="column">
			<img width="300" src="images/Zephyr_RTOS_logo_2015.svg.png" alt="Zephyr Logo">
		</div>
		<div class="column">
			<img width="300" src="images/Frama-C_logo,_full.png" alt="Frama-C Logo">
		</div>
	</div>
</section>
</section>

<section>
<section>
	<h3>Pico SDK</h3>
	<div class="fragment fade-up citation">
		<div class="cite">The SDK [...] provides the headers, libraries and build system necessary to write programs 
			for RP2040-based devices such as Raspberry Pi Pico in C, C++ or Arm assembly language.
		</div>
		<div class="source">
			Raspberry Pi Pico C/C++ SDK
		</div>
	</div>
	<ul>
		<li class="fragment fade-up">SDK provided by Raspberry Pi Ltd.</li>
		<li class="fragment fade-up">Consists of:</li>
		<ul>
			<li class="fragment fade-up">Higher-level libraries (pico_xxx)</li>
			<li class="fragment fade-up">Runtime support (e.g. pico_standard_link)</li>
			<li class="fragment fade-up">Hardware support libraries (hardware_xxx)</li>
			<li class="fragment fade-up">Hardware struct/register libraries</li>
		</ul>
	</ul>
</section>

<section>
	<h3>An example application</h3>
	<div class="dirtree">
		<ul class="dir-list">
			<li class="folder">blinky
					<ul>
					<li>CMakeLists.txt</li>
					<li>pico_sdk_import.cmake</li>
					<li>main.c</li>
				</ul>
			</li>
		</ul>
	</div>
</section>

<section>
	<h3>main.c</h3>
	<pre class="C"><code data-trim data-noescape data-line-numbers="|1|3|5-13|6,7|10|11|">
		#include "pico/stdlib.h"

		const static uint led_pin = 0; 

		int main() {
			gpio_init(led_pin); 
			gpio_set_dir(led_pin, GPIO_OUT); 

			for(;;){
				gpio_xor_mask(1 << led_pin); 
				sleep_ms(500); 
			}
		}
	</code></pre>
</section>

<section>
	<h3>CMakeLists.txt</h3>
	<pre class="cmake"><code data-trim data-noescape data-line-numbers="|1|3,4,6|8|10,11|">
		cmake_minimum_required(VERSION 3.13)

		include(pico_sdk_import.cmake)
		project(blinky) 
		
		pico_sdk_init() 

		add_executable(blinky main.c)

		pico_add_extra_outputs(blinky) 
		target_link_libraries(blinky pico_stdlib)
	</code></pre>
</section>

<section>
	<h3>Building the application</h3>
	<pre class="C"><code data-trim data-noescape>
		$ mkdir build 
		$ cd build 
		$ cmake .. 
		$ make 
	</code></pre>
</section>

<section>
	<h3>Going further</h3>
	<ul>
		<li>Look at the recommend reading</li>
		<li><a href="https://raspberrypi.github.io/pico-sdk-doxygen/index.html">https://raspberrypi.github.io/pico-sdk-doxygen/index.html</a></li>
	</ul>
</section>
</section>

<!-- <section>
	<h2>Let's have a look at studium</h2>
</section> -->

<section>
	<h1>Thanks for today!</h1>
</section>

<!-- END SLIDES -->
</div>
</div>
		<script src="reveal.js/dist/reveal.js"></script>
		<script src="reveal.js/plugin/notes/notes.js"></script>
		<script src="reveal.js/plugin/markdown/markdown.js"></script>
		<script src="reveal.js/plugin/highlight/highlight.js"></script>
		<script src="reveal.js/plugin/math/math.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,
				controlsTutorial: false,
				progress: true, 
				navigationMode: 'linear',
				transition: 'fade', 
				slideNumber: 'c', 
				pdfSeparateFragments: false, 
				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes, RevealMath.KaTeX ]
			});
		</script>
	</body>
</html>
